!function(a,b){function c(b,c){if(a.proxyAll(this,"show","hide","toggle","pos","unhover","onWindowResize","onDocumentClick","onUiElementOpen"),this.context=a(b).addClass("rich-tooltip-context"),this.options=a.extend({},g,c||{}),this.content=a(this.options.content).eq(0).addClass("rich-tooltip-content"),0===this.content.length)throw new Error("jquery.richTooltip: failed to find desired tooltip");this.content.addClass("rich-tooltip-pos-"+this.options.pos),this.context.attr("data-rel","tooltip"),"hover"===this.options.action?(a.fn.hoverDelay?(this.context.hoverDelay(this.show,this.unhover,{delayOver:200,delayOut:500,addChildren:this.content}),this.content.hoverDelay(this.show,this.unhover,{delayOver:200,delayOut:500,addChildren:this.context})):(this.context.hover(this.show,this.unhover),this.content.hover(this.show,this.unhover)),this.context.on("press",a.proxy(function(a){"touch"===a.pointerType&&(a.preventClick(),this.toggle(a))},this))):this.context.on("click",this.toggle),this.container=this.options.container?a(this.options.container):null,this.arrow=this.content.find(".rich-tooltip-arrow"),0===this.arrow.length&&(this.arrow=a('<div class="rich-tooltip-arrow"></div>').appendTo(this.content)),this.content.on("click",'[data-rel="close"]',this.hide)}function d(a){var b,c,d=0;if(this.length)for(;a.length&&a[0]!==document;)b=a.css("position"),"absolute"!==b&&"relative"!==b&&"fixed"!==b||(c=parseInt(a.css("zIndex"),10),isNaN(c)||0===c||c>d&&(d=c)),a=a.parent();return d}var e={south:"north",north:"south",east:"west",west:"east"},f=["north","south","west","east"],g={pos:"south",arrowDirection:null,arrowStyle:"outset",closeOnWindowResize:!0,closeOnDocumentClick:!0};c.prototype.unhover=function(){this._clearHoverTimeout(),this.hoverTimeout=setTimeout(this.hide,250)},c.prototype._clearHoverTimeout=function(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)},c.prototype.show=function(){if(this._clearHoverTimeout(),!this.visible){var b=d(this.content.parent());b>0&&this.content.css("z-index",b+1),this.content.parent().is("body")||this.content.appendTo("body"),a(document).trigger("ui.element.open",this),this.content.show(),this.pos(),this.visible=!0,this.context.addClass("rich-tooltip-open").trigger("richTooltip:open"),this.viewportSize={height:a(window).height(),width:a(window).width()},this.options.closeOnWindowResize&&a(window).on("resize",this.onWindowResize),this.options.closeOnDocumentClick&&a(document).on("click",this.onDocumentClick),a(document).one("ui.element.open",this.onUiElementOpen)}},c.prototype.hide=function(){this._clearHoverTimeout(),this.visible&&(this.content.hide(),this.visible=!1,this.context.removeClass("rich-tooltip-open").trigger("richTooltip:close"),this.options.closeOnWindowResize&&a(window).off("resize",this.onWindowResize),this.options.closeOnDocumentClick&&a(document).off("click",this.onDocumentClick),a(document).off("ui.element.open",this.onUiElementOpen))},c.prototype.toggle=function(a){a&&(a.preventDefault(),a.stopPropagation()),this.visible?this.hide():this.show()},c.prototype.onUiElementOpen=function(a,b){b!==this&&this.hide()},c.prototype.onWindowResize=function(){a(window).height()==this.viewportSize.height&&a(window).width()==this.viewportSize.width||this.hide()},c.prototype.onDocumentClick=function(b){var c=a(b.target);c.is(this.content)||c.isChildOf(this.content)||this.hide()},c.prototype.pos=function(){var b="inset"===this.options.arrowStyle||"none"==this.arrow.css("display")?0:15,c=a.calcRestrainedPos({giveMeSomething:!0,direction:this.options.pos,content:this.content.css("max-width","100%"),context:this.context,container:this.container,reset:{margin:0},offsets:{viewport:10,vertical:b,horizontal:b}}),d=c.pos;c.direction!==this.options.pos&&this.content.removeClass("rich-tooltip-pos-"+this.options.pos).addClass("rich-tooltip-pos-"+c.direction);var g=this.options.arrowDirection||e[c.direction];this.content.css(d),this.arrow.removeClass(f.join(" ")).addClass(g)},a.fn.tooltip=a.fn.richTooltip=function(b){var d=a(this),e=d.data("__tooltip");return e||(e=new c(d,b),d.data("__tooltip",e)),"string"==typeof b&&b in e&&e[b](),this},a.fn.isChildOf=function(b){for(var c=a(this).parents(),d=0;d<c.length;d++)if(a(c[d]).is(b))return!0;return!1},a(function(){function c(c,d){var e=c.data();return d||(d=a(e.tooltip)),{content:d,action:e.tooltipAction||"click",pos:e.tooltipPos||"south",container:e.tooltipContainer||b,arrowDirection:e.tooltipArrowDirection||null,arrowStyle:e.tooltipArrowStyle||null,closeOnWindowResize:e.tooltipIgnoreWindowResize===b,closeOnDocumentClick:e.tooltipIgnoreDocumentClick===b}}a('[data-rel="tooltip"] + aside').each(function(b,d){var e=a(d),f=e.prev();f.richTooltip(c(f,e))}),a("[data-tooltip]").each(function(b,d){d=a(d),d.richTooltip(c(d))})})}(jQuery);