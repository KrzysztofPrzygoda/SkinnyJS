!function(t){var e={apply:!1,container:null,direction:"north",offsets:{},viewport:!0},i={north:"east",east:"south",south:"west",west:"north"};t.calcRestrainedPos=function(n){var o=(n=t.extend({},e,n)).contentSizes,h=n.bounds||t(n.content).clientRect(),a=n.contextBounds||t(n.context).clientRect(),d=n.containerBounds||(n.container?t(n.container).clientRect():null),r=n.exclusions,l=n.viewportBounds||{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight},p={x:t(window).scrollLeft(),y:t(window).scrollTop()},c=t.extend({padding:0,viewport:0,container:0,vertical:0,horizontal:0},n.offsets||{}),f=n.reset||{};function m(t){var e;return o&&(e=o[t]),e||(e=h),e}function g(t){switch(t){case"north":f.top=a.top-h.height-c.vertical,f.left=Math.max(c.padding,a.left+a.width/2-h.width/2),n.cornerAdjacent&&!x(t,f)&&(f.left=a.left+c.padding);break;case"east":f.top=a.top+a.height/2-h.height/2,f.left=a.left+a.width+c.horizontal,n.cornerAdjacent&&!x(t,f)&&(f.top=a.top+c.padding);break;case"south":f.top=a.top+a.height+c.vertical,f.left=Math.max(c.padding,a.left+a.width/2-h.width/2),n.cornerAdjacent&&!x(t,f)&&(f.left=a.left+c.padding);break;case"west":f.top=a.top+a.height/2-h.height/2,f.left=a.left-h.width-c.horizontal,n.cornerAdjacent&&!x(t,f)&&(f.top=a.top+c.padding)}}function w(t,e,i,n,o){for(var d,r,l,p,c,f=[{min:t,max:e}];f.length&&(c=o());)for(r=c.pos-(n+i),l=c.pos+c.size+n,d=0;d<f.length;d++){if(r<=(p=f[d]).min)l>p.min&&(p.min=Math.max(p.min,l));else if(l>=p.max)p.max=Math.min(p.max,r);else{var m={min:l,max:p.max};p.max=r,m.min<m.max&&f.splice(d+1,0,m)}p.min>=p.max&&(f.splice(d,1),d--)}var g,w=a.left+(a.width-h.width)/2,s=t-1,u=Number.MAX_VALUE;for(d=0;d<f.length&&u>0;d++)w<(p=f[d]).min?(g=p.min-w)<u&&(s=p.min,u=g):w>p.max?(g=w-p.max)<u&&(s=p.max,u=g):(s=w,u=0);return(s<t||s>e)&&(s=null),s}function s(t,e){if(r){var i,o,d,l,p=0,m=r.slice();if("east"===t||"west"===t){var g=e.minX-c.horizontal,s=e.minX+h.width+c.horizontal;i=e.minY,o=e.maxY,l=h.height,n.cornerAdjacent&&h.height>a.height&&m.splice(0,0,{left:g,width:s-g,top:a.top+a.height-h.height,height:h.height-a.height}),null!==(d=w(i,o,l,c.vertical,function(){for(var t,e=null;!e&&p<m.length;p++)(t=m[p]).left<=s&&t.left+t.width>=g&&(e={pos:t.top,size:t.height});return e}))?(f.left=e.minX,f.top=d):(f.left=e.minX-1,f.top=e.minY-1)}else{var u=e.minY-c.vertical,x=e.minY+h.height+c.vertical;i=e.minX,o=e.maxX,l=h.width,n.cornerAdjacent&&h.width>a.width&&m.splice(0,0,{top:u,height:x-u,left:a.left+a.width-h.width,width:h.width-a.width}),null!==(d=w(i,o,l,c.horizontal,function(){for(var t,e=null;!e&&p<m.length;p++)(t=m[p]).top<=x&&t.top+t.height>=u&&(e={pos:t.left,size:t.width});return e}))?(f.left=d,f.top=e.minY):(f.left=e.minX-1,f.top=e.minY-1)}}}function u(t,e){switch(t){case"north":case"south":e.minX=Math.max(e.minX,a.left-h.width+c.padding),e.maxX=Math.min(a.left+a.width-c.padding,e.maxX-h.width),e.minY=e.maxY=f.top;break;case"east":case"west":e.minY=Math.max(e.minY,a.top-h.height+c.padding),e.maxY=Math.min(a.top+a.height-c.padding,e.maxY-h.height),e.minX=e.maxX=f.left}return e}function x(t,e){var i=!0;switch(t){case"north":case"south":i=e.left>=a.left+c.padding&&e.left<=a.left+a.width-c.padding||e.left+h.width<=a.left+a.width-c.padding&&e.left+h.width>=a.left+c.padding;break;case"east":case"west":i=e.top>=a.top+c.padding&&e.top<=a.top+a.bottom-c.padding||e.top+h.height<=a.top+a.height-c.padding&&e.top+h.height<=a.top+a.height-c.padding}return i}var v=n.direction;v in i||(v="north");var X,Y,A,j,M=v;X=Y=0,A=l.width,j=l.height,null!==d&&(X=d.left+c.container,Y=d.top+c.container,A=d.left+d.width-c.container,j=d.top+d.height-c.container),!0===n.viewport&&(X=Math.max(c.viewport,X),Y=Math.max(c.viewport,Y),A=Math.min(l.width-c.viewport,A),j=Math.min(l.height-c.viewport,j));for(var b;;){h=m(v),g(v),b=u(v,{minX:X,minY:Y,maxX:A,maxY:j}),E=v,W=b,null!==d&&(f.top<d.top?(f.top=d.top+c.container,!n.cornerAdjacent||"east"!==E&&"west"!==E||x(E,f)||(f.top=a.top+c.padding,W.minY=f.top)):f.top+h.height>d.top+d.height&&(f.top=d.top+d.height-h.height-c.container,!n.cornerAdjacent||"east"!==E&&"west"!==E||x(E,f)||(f.top=a.top+a.height-c.padding-h.height,W.maxY=f.top)),f.left+h.width>d.left+d.width?(f.left=d.left+d.width-h.width-c.container,!n.cornerAdjacent||"north"!==E&&"south"!==E||x(E,f)||(f.left=a.left+a.width-c.padding-h.width,W.maxX=f.left)):f.left<d.left&&(f.left=d.left+c.container,!n.cornerAdjacent||"north"!==E&&"south"!==E||x(E,f)||(f.left=a.left+c.padding,W.minX=f.left))),B=v,R=b,!0===n.viewport&&(f.top<p.y+c.viewport?(f.top=p.y+c.viewport,!n.cornerAdjacent||"east"!==B&&"west"!==B||x(B,f)||(f.top=a.top+c.padding,R.minY=f.top)):f.top+h.height>p.y+l.height&&(f.top=p.y+l.height-h.height-c.viewport,!n.cornerAdjacent||"east"!==B&&"west"!==B||x(B,f)||(f.top=a.top+a.height-c.padding-h.height,R.maxY=f.top)),f.left+h.width>p.x+l.width?(f.left=p.x+l.width-h.width-c.viewport,!n.cornerAdjacent||"north"!==B&&"south"!==B||x(B,f)||(f.left=a.left+a.width-c.padding-h.width,R.maxX=f.left)):f.left<p.x+c.viewport&&(f.left=p.x+c.viewport,!n.cornerAdjacent||"north"!==B&&"south"!==B||x(B,f)||(f.left=a.left+c.padding,R.minX=f.left))),y=b,(k=f).left>=y.minX&&k.left<=y.maxX&&k.top>=y.minY&&k.top<=y.maxY&&s(v,b);var z=t.extend({},h,f);if(!(n.cornerAdjacent&&!x(v,f)||t.doBoundingBoxesIntersect(z,a)))break;if(i[v]===M){if(n.giveMeSomething)break;return null}v=i[v]}var k,y,B,R,E,W;return f.maxWidth=l.width-f.left-c.viewport,h.width>=l.width&&(f.width="auto",f.left="0px",f.margin="0 "+c.padding+"px",f.maxWidth="100%"),{direction:v,pos:f}},t.doBoundingBoxesIntersect=function(t,e){return t.left<e.left+e.width&&t.left+t.width>e.left&&t.top<e.top+e.height&&t.top+t.height>e.top}}(jQuery);