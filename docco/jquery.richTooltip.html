<!DOCTYPE html>

<html>
<head>
  <title>jquery.richTooltip.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="breakpoints.html">
                breakpoints.js
              </a>
            
              
              <a class="source" href="date-parse.html">
                date-parse.js
              </a>
            
              
              <a class="source" href="jquery.breakpoints.html">
                jquery.breakpoints.js
              </a>
            
              
              <a class="source" href="jquery.calcRestrainedPos.html">
                jquery.calcRestrainedPos.js
              </a>
            
              
              <a class="source" href="jquery.clientRect.html">
                jquery.clientRect.js
              </a>
            
              
              <a class="source" href="jquery.contentSize.html">
                jquery.contentSize.js
              </a>
            
              
              <a class="source" href="jquery.cookies.html">
                jquery.cookies.js
              </a>
            
              
              <a class="source" href="jquery.css.html">
                jquery.css.js
              </a>
            
              
              <a class="source" href="jquery.customEvent.html">
                jquery.customEvent.js
              </a>
            
              
              <a class="source" href="jquery.delimitedString.html">
                jquery.delimitedString.js
              </a>
            
              
              <a class="source" href="jquery.disableEvent.html">
                jquery.disableEvent.js
              </a>
            
              
              <a class="source" href="jquery.hostIframe.html">
                jquery.hostIframe.js
              </a>
            
              
              <a class="source" href="jquery.hoverDelay.html">
                jquery.hoverDelay.js
              </a>
            
              
              <a class="source" href="jquery.htmlEncode.html">
                jquery.htmlEncode.js
              </a>
            
              
              <a class="source" href="jquery.imageSize.html">
                jquery.imageSize.js
              </a>
            
              
              <a class="source" href="jquery.isVisibleKeyCode.html">
                jquery.isVisibleKeyCode.js
              </a>
            
              
              <a class="source" href="jquery.menu.html">
                jquery.menu.js
              </a>
            
              
              <a class="source" href="jquery-menu-exampleskin.html">
                jquery-menu-exampleskin.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.deviceFixes.html">
                jquery.modalDialog.deviceFixes.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.getSettings.html">
                jquery.modalDialog.getSettings.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.header.html">
                jquery.modalDialog.header.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.history.html">
                jquery.modalDialog.history.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.html">
                jquery.modalDialog.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.unobtrusive.html">
                jquery.modalDialog.unobtrusive.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.userAgent.html">
                jquery.modalDialog.userAgent.js
              </a>
            
              
              <a class="source" href="jquery.modalDialogContent.header.html">
                jquery.modalDialogContent.header.js
              </a>
            
              
              <a class="source" href="jquery.modalDialogContent.html">
                jquery.modalDialogContent.js
              </a>
            
              
              <a class="source" href="jquery.msAjax.html">
                jquery.msAjax.js
              </a>
            
              
              <a class="source" href="jquery.ns.html">
                jquery.ns.js
              </a>
            
              
              <a class="source" href="jquery.partialLoad.html">
                jquery.partialLoad.js
              </a>
            
              
              <a class="source" href="jquery.postMessage.html">
                jquery.postMessage.js
              </a>
            
              
              <a class="source" href="jquery.proxyAll.html">
                jquery.proxyAll.js
              </a>
            
              
              <a class="source" href="jquery.queryString.html">
                jquery.queryString.js
              </a>
            
              
              <a class="source" href="jquery.richTooltip.html">
                jquery.richTooltip.js
              </a>
            
              
              <a class="source" href="jquery.scrollAnchor.html">
                jquery.scrollAnchor.js
              </a>
            
              
              <a class="source" href="jquery.uncomment.html">
                jquery.uncomment.js
              </a>
            
              
              <a class="source" href="jquery.url.html">
                jquery.url.js
              </a>
            
              
              <a class="source" href="pointy.gestures.html">
                pointy.gestures.js
              </a>
            
              
              <a class="source" href="pointy.html">
                pointy.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>jquery.richTooltip.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>/ <reference path="jquery.clientRect.js" />
/ <reference path="jquery.proxyAll.js" />
/ <reference path="jquery.calcRestrainedPos.js" />
/ <reference path="jquery.hoverDelay.js" /></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$, undefined</span>) </span>{
    <span class="hljs-keyword">var</span> arrowDirections = {
        <span class="hljs-attr">south</span>: <span class="hljs-string">'north'</span>,
        <span class="hljs-attr">north</span>: <span class="hljs-string">'south'</span>,
        <span class="hljs-attr">east</span>: <span class="hljs-string">'west'</span>,
        <span class="hljs-attr">west</span>: <span class="hljs-string">'east'</span>
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>commonly used array for looping over</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> directions = [<span class="hljs-string">'north'</span>, <span class="hljs-string">'south'</span>, <span class="hljs-string">'west'</span>, <span class="hljs-string">'east'</span>];

    <span class="hljs-keyword">var</span> defaults = {
        <span class="hljs-attr">pos</span>: <span class="hljs-string">'south'</span>,
        <span class="hljs-attr">arrowDirection</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">arrowStyle</span>: <span class="hljs-string">'outset'</span>,
        <span class="hljs-attr">closeOnWindowResize</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">closeOnDocumentClick</span>: <span class="hljs-literal">true</span>
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Tooltip</span>(<span class="hljs-params">context, options</span>) </span>{
        $.proxyAll(<span class="hljs-keyword">this</span>, <span class="hljs-string">'show'</span>, <span class="hljs-string">'hide'</span>, <span class="hljs-string">'toggle'</span>, <span class="hljs-string">'pos'</span>, <span class="hljs-string">'unhover'</span>, <span class="hljs-string">'onWindowResize'</span>, <span class="hljs-string">'onDocumentClick'</span>, <span class="hljs-string">'onUiElementOpen'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>target context element that initalizes this tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.context = $(context).addClass(<span class="hljs-string">'rich-tooltip-context'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>store options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.options = $.extend({}, defaults, options || {});</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>determine the content of the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.content = $(<span class="hljs-keyword">this</span>.options.content).eq(<span class="hljs-number">0</span>).addClass(<span class="hljs-string">'rich-tooltip-content'</span>); <span class="hljs-comment">// class adds legacy browser support</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>ensure we actually found the content</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.content.length === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'jquery.richTooltip: failed to find desired tooltip'</span>);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>add functional classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.content.addClass(<span class="hljs-string">'rich-tooltip-pos-'</span> + <span class="hljs-keyword">this</span>.options.pos);</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>configure the context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.context.attr(<span class="hljs-string">'data-rel'</span>, <span class="hljs-string">'tooltip'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>setup the hover events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.action === <span class="hljs-string">'hover'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>soft dependency on hoverDelay</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> ($.fn.hoverDelay) {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>hover is desktop only, and does not support pointer events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.context.hoverDelay(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover, { <span class="hljs-attr">delayOver</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">delayOut</span>: <span class="hljs-number">500</span>, <span class="hljs-attr">addChildren</span>: <span class="hljs-keyword">this</span>.content });</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>hover over the tooltip content should not hide the tooltip yet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.content.hoverDelay(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover, { <span class="hljs-attr">delayOver</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">delayOut</span>: <span class="hljs-number">500</span>, <span class="hljs-attr">addChildren</span>: <span class="hljs-keyword">this</span>.context });
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>hover is desktop only, and does not support pointer events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.context.hover(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover);</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>hover over the tooltip content should not hide the tooltip yet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.content.hover(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover);
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>listen to pointer down and record the event to be used on click
calling prevent default on pointerup/pointerdown does not
prevent navigation, preventDefault must happen within click event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context.on(<span class="hljs-string">'press'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>toggle visibility on touches</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (event.pointerType === <span class="hljs-string">'touch'</span>) {
                    event.preventClick();
                    <span class="hljs-keyword">this</span>.toggle(event);
                }
            }, <span class="hljs-keyword">this</span>));
        } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>when hover is off, we simply toggle on click event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context.on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.toggle);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>find the container element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.container = <span class="hljs-keyword">this</span>.options.container ? $(<span class="hljs-keyword">this</span>.options.container) : <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>look for exiting arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.arrow = <span class="hljs-keyword">this</span>.content.find(<span class="hljs-string">'.rich-tooltip-arrow'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>no arrow found, create one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.arrow.length === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">this</span>.arrow = $(<span class="hljs-string">'&lt;div class="rich-tooltip-arrow"&gt;&lt;/div&gt;'</span>).appendTo(<span class="hljs-keyword">this</span>.content);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>anything with [data-rel=”close”] can be used to close the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.content.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-rel="close"]'</span>, <span class="hljs-keyword">this</span>.hide);
    }

    Tooltip.prototype.unhover = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>._clearHoverTimeout();
        <span class="hljs-keyword">this</span>.hoverTimeout = setTimeout(<span class="hljs-keyword">this</span>.hide, <span class="hljs-number">250</span>);
    };

    Tooltip.prototype._clearHoverTimeout = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hoverTimeout) {
            clearTimeout(<span class="hljs-keyword">this</span>.hoverTimeout);
            <span class="hljs-keyword">this</span>.hoverTimeout = <span class="hljs-literal">null</span>;
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Borrowed from the JQuery UI core method zIndex. 
See <a href="https://github.com/jquery/jquery-ui/blob/master/ui/core.js">https://github.com/jquery/jquery-ui/blob/master/ui/core.js</a> </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findZIndex</span>(<span class="hljs-params"> elem </span>) </span>{
        <span class="hljs-keyword">var</span> pos;
        <span class="hljs-keyword">var</span> zIndexVal;
        <span class="hljs-keyword">var</span> maxZIndexVal = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.length ) {
            <span class="hljs-keyword">while</span> ( elem.length &amp;&amp; elem[ <span class="hljs-number">0</span> ] !== <span class="hljs-built_in">document</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Ignore z-index if position is set to a value where z-index is ignored by the browser
This makes behavior of this function consistent across browsers
WebKit always returns auto if the element is positioned</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                pos = elem.css( <span class="hljs-string">'position'</span> );
                <span class="hljs-keyword">if</span> ( pos === <span class="hljs-string">'absolute'</span> || pos === <span class="hljs-string">'relative'</span> || pos === <span class="hljs-string">'fixed'</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>IE returns 0 when zIndex is not specified
other browsers return a string
we ignore the case of nested elements with an explicit value of 0</p>
<div style="z-index: -10;"><div style="z-index: 0;"></div></div>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    zIndexVal = <span class="hljs-built_in">parseInt</span>( elem.css( <span class="hljs-string">'zIndex'</span> ), <span class="hljs-number">10</span> );
                    <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( zIndexVal ) &amp;&amp; zIndexVal !== <span class="hljs-number">0</span> ) {
                        <span class="hljs-keyword">if</span> (zIndexVal &gt; maxZIndexVal) {
                            maxZIndexVal = zIndexVal;
                        }
                    }
                }
                elem = elem.parent();
            }
        }

        <span class="hljs-keyword">return</span> maxZIndexVal;
    }

    Tooltip.prototype.show = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>._clearHoverTimeout();

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.visible) {
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">var</span> zIndex = findZIndex(<span class="hljs-keyword">this</span>.content.parent());</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>if the tooltip has a parent with z-index, set tooltip’s one higher.
In case the tooltip being used inside a control like a modal dialog.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (zIndex &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">this</span>.content.css(<span class="hljs-string">'z-index'</span>, zIndex + <span class="hljs-number">1</span>);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>move the content to the body to avoid positioning conflicts</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.content.parent().is(<span class="hljs-string">'body'</span>)) { 
            <span class="hljs-keyword">this</span>.content.appendTo(<span class="hljs-string">'body'</span>);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>tell other ui events we are opening, hopefully they all close themselves</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-built_in">document</span>).trigger(<span class="hljs-string">'ui.element.open'</span>, <span class="hljs-keyword">this</span>);

        <span class="hljs-keyword">this</span>.content.show();
        <span class="hljs-keyword">this</span>.pos();</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>mark the tooltip as visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>indicate to the context the tooltip is open</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.context.addClass(<span class="hljs-string">'rich-tooltip-open'</span>).trigger(<span class="hljs-string">'richTooltip:open'</span>);

        <span class="hljs-keyword">this</span>.viewportSize = {
            <span class="hljs-attr">height</span>: $(<span class="hljs-built_in">window</span>).height(),
            <span class="hljs-attr">width</span>: $(<span class="hljs-built_in">window</span>).width()
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>hide the tooltip if the browser resizes, the user can open it back up easily</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.closeOnWindowResize) {
            $(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'resize'</span>, <span class="hljs-keyword">this</span>.onWindowResize);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>hide the tooltip if user clicks outside of the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.closeOnDocumentClick) {
            $(<span class="hljs-built_in">document</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.onDocumentClick);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>listen for other ui elements opening, and if one opens, close this tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-built_in">document</span>).one(<span class="hljs-string">'ui.element.open'</span>, <span class="hljs-keyword">this</span>.onUiElementOpen);
    };

    Tooltip.prototype.hide = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>._clearHoverTimeout();

        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.visible) {
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">this</span>.content.hide();</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>mark the tooltip as not visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>indicate to the context the tooltip is now closed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.context.removeClass(<span class="hljs-string">'rich-tooltip-open'</span>).trigger(<span class="hljs-string">'richTooltip:close'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>remove event listeners</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.closeOnWindowResize) {
            $(<span class="hljs-built_in">window</span>).off(<span class="hljs-string">'resize'</span>, <span class="hljs-keyword">this</span>.onWindowResize);
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.closeOnDocumentClick) {
            $(<span class="hljs-built_in">document</span>).off(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.onDocumentClick);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>stop listening for other ui elements opening, since we no longer need to care</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-built_in">document</span>).off(<span class="hljs-string">'ui.element.open'</span>, <span class="hljs-keyword">this</span>.onUiElementOpen);
    };

    Tooltip.prototype.toggle = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-keyword">if</span> (event) {
            event.preventDefault();</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>we need to call stop propagation or else this will trigger
up to the document and result in closing the tooltip.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            event.stopPropagation();
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.visible) {
            <span class="hljs-keyword">this</span>.hide();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.show();
        }
    };

    Tooltip.prototype.onUiElementOpen = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event, item</span>) </span>{
        <span class="hljs-keyword">if</span> (item !== <span class="hljs-keyword">this</span>) {
            <span class="hljs-keyword">this</span>.hide();
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>on window resize, confirm the window actually changed sizes
IE9 and below triggers a resize on any element changing size,
this includes elements becoming visible or hidding
@see <a href="http://stackoverflow.com/questions/1852751/window-resize-event-firing-in-internet-explorer">http://stackoverflow.com/questions/1852751/window-resize-event-firing-in-internet-explorer</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Tooltip.prototype.onWindowResize = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> ($(<span class="hljs-built_in">window</span>).height() != <span class="hljs-keyword">this</span>.viewportSize.height || $(<span class="hljs-built_in">window</span>).width() != <span class="hljs-keyword">this</span>.viewportSize.width) {
            <span class="hljs-keyword">this</span>.hide();
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>on a document click event, we close the tooltip is the click
was not to the tooltip or a child of the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Tooltip.prototype.onDocumentClick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">var</span> target = $(e.target);
        <span class="hljs-keyword">if</span> (!target.is(<span class="hljs-keyword">this</span>.content) &amp;&amp; !target.isChildOf(<span class="hljs-keyword">this</span>.content)) {
            <span class="hljs-keyword">this</span>.hide();
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>padding constant used during position calculations. TODO: compute these dynamically based on the control’s actual CSS</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> PADDING = <span class="hljs-number">10</span>;
    <span class="hljs-keyword">var</span> ARROW_WIDTH = <span class="hljs-number">15</span>;

    Tooltip.prototype.pos = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>find the size of the arrow
.css-arrow elements do not have a size itself because it uses :before and :after</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> arrowSize = <span class="hljs-keyword">this</span>.options.arrowStyle === <span class="hljs-string">'inset'</span> || <span class="hljs-keyword">this</span>.arrow.css(<span class="hljs-string">'display'</span>) == <span class="hljs-string">'none'</span> ? <span class="hljs-number">0</span> : ARROW_WIDTH;

        <span class="hljs-keyword">var</span> restrainedPos = $.calcRestrainedPos({
            <span class="hljs-attr">giveMeSomething</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">direction</span>: <span class="hljs-keyword">this</span>.options.pos,
            <span class="hljs-attr">content</span>: <span class="hljs-keyword">this</span>.content.css(<span class="hljs-string">'max-width'</span>, <span class="hljs-string">'100%'</span>),
            <span class="hljs-attr">context</span>: <span class="hljs-keyword">this</span>.context,
            <span class="hljs-attr">container</span>: <span class="hljs-keyword">this</span>.container,
            <span class="hljs-attr">reset</span>: {
                <span class="hljs-attr">margin</span>: <span class="hljs-number">0</span>
            },
            <span class="hljs-attr">offsets</span>: {
                <span class="hljs-attr">viewport</span>: PADDING,
                <span class="hljs-attr">vertical</span>: arrowSize,
                <span class="hljs-attr">horizontal</span>: arrowSize
            }
        });

        <span class="hljs-keyword">var</span> pos = restrainedPos.pos;

        <span class="hljs-keyword">if</span> (restrainedPos.direction !== <span class="hljs-keyword">this</span>.options.pos) {
            <span class="hljs-keyword">this</span>.content
                .removeClass(<span class="hljs-string">'rich-tooltip-pos-'</span> + <span class="hljs-keyword">this</span>.options.pos)
                .addClass(<span class="hljs-string">'rich-tooltip-pos-'</span> + restrainedPos.direction);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>determine the new arrow direction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> arrowDirection = <span class="hljs-keyword">this</span>.options.arrowDirection || arrowDirections[restrainedPos.direction];

        <span class="hljs-keyword">this</span>.content.css(pos);

        <span class="hljs-keyword">this</span>.arrow</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>remove any previously added tooltip arrow direction class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .removeClass(directions.join(<span class="hljs-string">' '</span>))</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>add the tooltip arrow direction class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .addClass(arrowDirection);
    };

    $.fn.tooltip = $.fn.richTooltip = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jQueryTooltip</span>(<span class="hljs-params">options</span>) </span>{
        <span class="hljs-keyword">var</span> el = $(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">var</span> tooltip = el.data(<span class="hljs-string">'__tooltip'</span>);

        <span class="hljs-keyword">if</span> (!tooltip) {
            tooltip = <span class="hljs-keyword">new</span> Tooltip(el, options);
            el.data(<span class="hljs-string">'__tooltip'</span>, tooltip);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>allow this to be used to run methods on the tooltips</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options === <span class="hljs-string">'string'</span> &amp;&amp; options <span class="hljs-keyword">in</span> tooltip) {
            tooltip[options]();
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };

    $.fn.isChildOf = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jQueryIsChildOf</span>(<span class="hljs-params">filter_string</span>) </span>{
        <span class="hljs-keyword">var</span> parents = $(<span class="hljs-keyword">this</span>).parents();

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; parents.length; j++) {
            <span class="hljs-keyword">if</span> ($(parents[j]).is(filter_string)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>initialize all existing tooltips</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    $(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>translate data attributes to options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getOptionsFromData</span>(<span class="hljs-params">context, content</span>) </span>{
            <span class="hljs-keyword">var</span> data = context.data();

            <span class="hljs-keyword">if</span> (!content) {
                content = $(data.tooltip);
            }

            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">content</span>: content,
                <span class="hljs-attr">action</span>: data.tooltipAction || <span class="hljs-string">'click'</span>,
                <span class="hljs-attr">pos</span>: data.tooltipPos || <span class="hljs-string">'south'</span>,
                <span class="hljs-attr">container</span>: data.tooltipContainer || <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">arrowDirection</span>: data.tooltipArrowDirection || <span class="hljs-literal">null</span>,
                <span class="hljs-attr">arrowStyle</span>: data.tooltipArrowStyle || <span class="hljs-literal">null</span>,
                <span class="hljs-attr">closeOnWindowResize</span>: data.tooltipIgnoreWindowResize === <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">closeOnDocumentClick</span>: data.tooltipIgnoreDocumentClick === <span class="hljs-literal">undefined</span>
            };
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>convert <span data-rel="tooltip" /><aside /> to tooltips</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'[data-rel="tooltip"] + aside'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">i, el</span>) </span>{
            <span class="hljs-keyword">var</span> content = $(el); <span class="hljs-comment">// this is the aside</span>
            <span class="hljs-keyword">var</span> context = content.prev(); <span class="hljs-comment">// element prior to aside</span>

            context.richTooltip(getOptionsFromData(context, content));
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>allow instances without the <aside> directly after the context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'[data-tooltip]'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">i, context</span>) </span>{
            context = $(context);
            context.richTooltip(getOptionsFromData(context));
        });
    });
})(jQuery);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
